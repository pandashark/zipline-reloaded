Development
-----------

:Release: x.x.x
:Date: TBD

.. warning::
   This release is still under active development.  All changes listed are
   subject to change at any time.


Highlights
~~~~~~~~~~

None

Enhancements
~~~~~~~~~~~~

None

Experimental Features
~~~~~~~~~~~~~~~~~~~~~

.. warning::

   Experimental features are subject to change.

None

Bug Fixes
~~~~~~~~~

- Fix ``execute_daily_cancel_policy`` to cancel all orders for all assets at
  end of day, not just the first order for assets with multiple orders.
  Previously, assets with a single open order were skipped entirely. (:issue:`313`)
- Fix ``NoSlippage.process_order`` and ``FixedSlippage.process_order`` to use
  ``order.open_amount`` instead of ``order.amount``, preventing overfill of
  partially filled orders. (:issue:`313`)
- Fix ``VolumeShareSlippage.process_order`` to return ``(None, None)`` instead
  of bare ``None`` when price is NaN, preventing ``TypeError`` during tuple
  unpacking. (:issue:`313`)
- Fix ``before_trading_start`` to reset ``_in_before_trading_start`` flag via
  ``try/finally``, preventing orders from being permanently blocked after an
  exception in the user's callback. (:issue:`313`)
- Fix ``validate_order_params`` and ``__convert_order_params_for_blotter`` to
  use ``is not None`` checks for ``limit_price`` and ``stop_price`` instead of
  truthiness checks, allowing a price of ``0.0``. (:issue:`313`)
- Fix ``convert_cols`` in bcolz minute bar writer to use ``|=`` instead of
  ``&=`` for the exclude mask, so rows with uint32 overflow values are actually
  filtered out. (:issue:`314`)
- Fix infinite loop in ``DataPortal._get_daily_spot_value`` when searching
  backwards for a non-NaN close price by adding a bounds check against
  ``_first_trading_day``. (:issue:`314`)
- Fix infinite loop in ``BcolzDailyBarReader.get_last_traded_dt`` when
  ``NoDataAfterDate`` is raised and no previous session exists. (:issue:`314`)
- Fix ``DataPortal.get_adjustments`` to apply ``tz_localize`` to merger
  adjustment dates, consistent with splits and dividends. (:issue:`314`)
- Add path traversal validation to ``tar.extractall`` in the Quandl bundle
  loader (CVE-2007-4559). (:issue:`314`)
- Fix ``_weak_lru_cache`` double-counting cache misses and fix
  ``cache_clear()`` crash from subscripting integer counters. (:issue:`315`)
- Fix ``AssetFinder._lookup_symbol_strict`` to materialize ``map()`` iterator
  to a list before reuse, preventing empty ``options`` dict in
  ``SameSymbolUsedAcrossCountries`` error. (:issue:`315`)
- Fix ``AssetDBWriter._all_tables_present`` to check all tables instead of
  returning after the first one. (:issue:`315`)
- Fix ``BeforeClose.calculate_dates`` to compare ``self.cal.name`` instead of
  ``self.cal`` to the string ``"us_futures"``. (:issue:`315`)
- Fix ``AssetDBWriter.write_direct`` argument order for futures, which
  previously swapped the data and defaults arguments to
  ``_generate_output_dataframe``. (:issue:`315`)
- Fix ``DataFrame.tz_localize()`` removal in pandas 2.0+ when reading benchmark
  returns (:issue:`xxx`).
- Fix ``np.isnan()`` on integer (uint32) volume values in HDF5 daily bar reader
  (:issue:`xxx`).
- Fix ``DatetimeIndex.freq`` returning ``None`` in pandas 2.0+ for session-based
  date arithmetic in ``BcolzMinuteBarWriter``, ``ContinuousFutureSessionBarReader``,
  and ``ContinuousFutureMinuteBarReader`` (:issue:`xxx`).
- Fix timezone-naive vs timezone-aware timestamp comparison in
  ``_ClassicRiskMetrics._periods_in_range`` (:issue:`xxx`).
- Replace deprecated ``pd.Timestamp.utcnow()`` with ``pd.Timestamp.now("UTC")``
  (:issue:`xxx`).
- Fix ``DataPortal._first_trading_minute`` set to ``(None, None)`` tuple instead
  of ``None`` when no first trading day is configured (:issue:`xxx`).
- Fix ``DataPortal._get_daily_spot_value`` passing ``"minute"`` instead of
  ``"daily"`` as data frequency to ``get_adjusted_value`` (:issue:`xxx`).

Performance
~~~~~~~~~~~

None

Maintenance and Refactorings
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

None

Build
~~~~~

None

Documentation
~~~~~~~~~~~~~

None

Miscellaneous
~~~~~~~~~~~~~

None
